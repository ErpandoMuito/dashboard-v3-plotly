"""
Local products database for testing and offline access
"""

PRODUTOS_DB = [
    {"id": 913366493, "codigo": 43692460684, "descricao": "06MP00108052 - BASE DISSIP SL V9 F3 FUND SAE/AC46000", "preco": 109.8, "marca": "Unicoba"},
    {"id": 913575755, "codigo": "PH-90", "descricao": "132819304 - UPPER AIR DUCT", "preco": 54.71, "marca": "Electrolux"},
    {"id": 913575779, "codigo": "PH-80", "descricao": "132819407 - LOWER AIR DUCT", "preco": 53.41, "marca": "Electrolux"},
    {"id": 913018453, "codigo": "PH-471", "descricao": "50731358 D-396937 TMDR FIAT 400ST 4G", "preco": 38.3, "marca": "BASF"},
    {"id": 913018510, "codigo": "PH-470", "descricao": "50731359 D-396938 TMEQ FIAT 400ST 4G", "preco": 38.3, "marca": "BASF"},
    {"id": 913199477, "codigo": "PH-473", "descricao": "50741638 D-373786 TMDR FIAT 300ST 4G", "preco": 40.74, "marca": "BASF"},
    {"id": 913199481, "codigo": "PH-474", "descricao": "50741639 D-381016 TMEQ FIAT 300ST 4G", "preco": 40.74, "marca": "BASF"},
    {"id": 910424889, "codigo": "PH-810", "descricao": "6578402 REAR HEAD CASTING VW UP 5MVC", "preco": 30.07, "marca": "Mahle"},
    {"id": 913567024, "codigo": "PH-100", "descricao": "A02829204 - ASSEMBLY SPIDER", "preco": 81.21, "marca": "Electrolux"},
    {"id": 913295929, "codigo": "PH-952", "descricao": "ANEL AMORTECEDOR 5G ", "preco": 8.77, "marca": "Anauger"},
    {"id": 900686547, "codigo": "PH-420", "descricao": "ANTIGO LH 20512001", "preco": 15.5, "marca": "SMR"},
    {"id": 900686569, "codigo": "PH-430", "descricao": "ANTIGO RH 20512002", "preco": 15.5, "marca": "SMR"},
    {"id": 892410784, "codigo": "PH-200", "descricao": "ARGUS 3 65010211", "preco": 68.47, "marca": "Ilumatic"},
    {"id": 893914022, "codigo": "PH-210", "descricao": "ARGUS 4 65010212", "preco": 101.8, "marca": "Ilumatic"},
    {"id": 897245184, "codigo": "PH-710", "descricao": "BRACKET 0170556", "preco": 114.02, "marca": "HBA"},
    {"id": 912907830, "codigo": "PH-950", "descricao": "CANECA DE ALUMINIO. N60 5G 21232", "preco": 15.51, "marca": "Anauger"},
    {"id": 912907833, "codigo": "PH-951", "descricao": "CARCAÇA DE ALUM. 5G 21235", "preco": 17.47, "marca": "Anauger"},
    {"id": 892454990, "codigo": "PH-920", "descricao": "CBR 3060003", "preco": 53.78, "marca": "Newtec"},
    {"id": 892461370, "codigo": "PH-930", "descricao": "CBR 3060004", "preco": 44.77, "marca": "Newtec"},
    {"id": 892670115, "codigo": "PH-30", "descricao": "CHAVETA CUBO IZA A05348001", "preco": 2.13, "marca": "Electrolux"},
    {"id": 894031521, "codigo": "PH-40", "descricao": "CHAVETA CUBO SONIA A12429101", "preco": 2.228, "marca": "Electrolux"},
    {"id": 892412735, "codigo": "PH-900", "descricao": "CHR 3060001", "preco": 52.62, "marca": "Newtec"},
    {"id": 892411801, "codigo": "PH-910", "descricao": "CHR 3060002", "preco": 53.78, "marca": "Newtec"},
    {"id": 913018308, "codigo": "PH-476", "descricao": "CONJUNTO MONTADO LH (HOUSING/CAP/CELLASTO INLAY)", "preco": 26.38, "marca": ""},
    {"id": 913018277, "codigo": "PH-478", "descricao": "CONJUNTO MONTADO RH (HOUSING/CAP/CELLASTO INLAY)", "preco": 26.38, "marca": ""},
    {"id": 892658665, "codigo": "PH-20", "descricao": "CUBO CESTO 16KG SANDRA A10606301", "preco": 33.5, "marca": "Electrolux"},
    {"id": 892671020, "codigo": "PH-50", "descricao": "CUBO CESTO 17KG A10606302", "preco": 40.327, "marca": "Electrolux"},
    {"id": 892672334, "codigo": "PH-10", "descricao": "CUBO CESTO IZA A05347901", "preco": 14.533, "marca": "Electrolux"},
    {"id": 913671486, "codigo": "PH-70", "descricao": "CUBO CESTO SONIA", "preco": 11.366, "marca": "Electrolux"},
    {"id": 899773071, "codigo": 9110000924, "descricao": "Ferramentas de fixação em máquinas 110008792", "preco": 60568, "marca": "Mahle"},
    {"id": 893812724, "codigo": "PH-300", "descricao": "FLANGE ASW1504-C41C0", "preco": 28.86, "marca": "Panasonic"},
    {"id": 906020793, "codigo": "PH-310", "descricao": "FLANGE WS1504-R6X00", "preco": 31.64, "marca": "Panasonic"},
    {"id": 900162481, "codigo": "PH-700", "descricao": "HOUSING 0170555", "preco": 157.91, "marca": "HBA"},
    {"id": 892407322, "codigo": "PH-150", "descricao": "JACK 305000100", "preco": 50.98, "marca": "DMP"},
    {"id": 892466107, "codigo": "PH-400", "descricao": "LH 21292001E", "preco": 15.64, "marca": "SMR"},
    {"id": 894404858, "codigo": "PH-1010", "descricao": "LPV1 - CORPO IRIS I 526x149 mm", "preco": 36.37, "marca": "Transvoltec"},
    {"id": 910034288, "codigo": "PH-1020", "descricao": "LPV2 - CORPO IRIS II 636x149 mm", "preco": 46.07, "marca": "Transvoltec"},
    {"id": 896684556, "codigo": "PH-1030", "descricao": "LPV3 - CORPO IRIS III 619x277 mm", "preco": 0, "marca": "Transvoltec"},
    {"id": 912541179, "codigo": "DDOT-R5-ferramenta", "descricao": "Manutenção Realizada no Molde 0170-556", "preco": 8550, "marca": "HBA"},
    {"id": 893437963, "codigo": "PH-518", "descricao": "R033B00063", "preco": 17.468, "marca": "Vibracoustic"},
    {"id": 893438579, "codigo": "PH-519", "descricao": "R033B00064", "preco": 16.98, "marca": "Vibracoustic"},
    {"id": 893439082, "codigo": "PH-520", "descricao": "R033B00065", "preco": 23.31, "marca": "Vibracoustic"},
    {"id": 893439680, "codigo": "PH-521", "descricao": "R033B00066", "preco": 5.95, "marca": "Vibracoustic"},
    {"id": 893440221, "codigo": "PH-522", "descricao": "R033B00068", "preco": 10.223, "marca": "Vibracoustic"},
    {"id": 892475059, "codigo": "PH-508", "descricao": "RBF40291361", "preco": 24.82, "marca": "Vibracoustic"},
    {"id": 899801003, "codigo": "PH-523", "descricao": "REB0500310", "preco": 20.088, "marca": "Vibracoustic"},
    {"id": 892474726, "codigo": "PH-507", "descricao": "REB0658317", "preco": 6.854, "marca": "Vibracoustic"},
    {"id": 892475364, "codigo": "PH-509", "descricao": "REB0778300", "preco": 32.583, "marca": "Vibracoustic"},
    {"id": 893434458, "codigo": "PH-510", "descricao": "REB0778310", "preco": 28.184, "marca": "Vibracoustic"},
    {"id": 892475739, "codigo": "PH-511", "descricao": "REB0779300", "preco": 40.595, "marca": "Vibracoustic"},
    {"id": 892476956, "codigo": "PH-512", "descricao": "REB0779310", "preco": 30.12, "marca": "Vibracoustic"},
    {"id": 892485576, "codigo": "PH-513", "descricao": "REB0823300", "preco": 36.729, "marca": "Vibracoustic"},
    {"id": 892485145, "codigo": "PH-514", "descricao": "REB0823310", "preco": 23.265, "marca": "Vibracoustic"},
    {"id": 898391526, "codigo": "PH-524", "descricao": "REE0256310", "preco": 17.29, "marca": "Vibracoustic"},
    {"id": 892486013, "codigo": "PH-515", "descricao": "REE0457300 ", "preco": 30.705, "marca": "Vibracoustic"},
    {"id": 892486392, "codigo": "PH-516", "descricao": "REE0457360", "preco": 14.243, "marca": "Vibracoustic"},
    {"id": 913383376, "codigo": 43692460691, "descricao": "REE0514300X", "preco": 32.453, "marca": "Vibracoustic"},
    {"id": 893436191, "codigo": "PH-525", "descricao": "REF0085310", "preco": 18.253, "marca": "Vibracoustic"},
    {"id": 893436379, "codigo": "PH-526", "descricao": "REK0218300", "preco": 19.051, "marca": "Vibracoustic"},
    {"id": 893437386, "codigo": "PH-527", "descricao": "REK0219300", "preco": 19.973, "marca": "Vibracoustic"},
    {"id": 893436619, "codigo": "PH-528", "descricao": "REK0220300", "preco": 20.686, "marca": "Vibracoustic"},
    {"id": 900162489, "codigo": "PH-529", "descricao": "REK0368310X", "preco": 30.63, "marca": "Vibracoustic"},
    {"id": 892472143, "codigo": "PH-505", "descricao": "REM0409360", "preco": 48.144, "marca": "Vibracoustic"},
    {"id": 892474558, "codigo": "PH-506", "descricao": "REM0411360", "preco": 9.775, "marca": "Vibracoustic"},
    {"id": 894169723, "codigo": "PH-517", "descricao": "REM0424300", "preco": 23.63, "marca": "Vibracoustic"},
    {"id": 892469141, "codigo": "PH-410", "descricao": "RH 21292002E", "preco": 15.64, "marca": "SMR"},
    {"id": 892469449, "codigo": "PH-500", "descricao": "RZ33015411", "preco": 46.121, "marca": "Vibracoustic"},
    {"id": 913368987, "codigo": "PH-954", "descricao": "SAÍDA 800 5G", "preco": 5.75, "marca": "Anauger"},
    {"id": 913368979, "codigo": "PH-953", "descricao": "SAÍDA 900 5G", "preco": 5.83, "marca": "Anauger"},
    {"id": 913062633, "codigo": "PH-472", "descricao": "SK019312 FCA INLAY BLK IMP", "preco": 22.25, "marca": "BASF"},
    {"id": 897421414, "codigo": "PH-60", "descricao": "SUPORTE RESISTÊNCIA VAPOR A21148301", "preco": 10.829, "marca": "Electrolux"},
    {"id": 910424704, "codigo": "PH-820", "descricao": "TM966001 FRONT HEAD CASTING VW UP 5MVC", "preco": 31.44, "marca": "Mahle"},
    {"id": 912672853, "codigo": "PH-650", "descricao": "V10 F2 - 49MP00107140 / 06MP00108089", "preco": 59.54, "marca": ""},
    {"id": 912506867, "codigo": "PH-660", "descricao": "V10 F3 - 49MP00107138 / 06MP00108088", "preco": 71.31, "marca": "Unicoba"},
    {"id": 912479888, "codigo": "PH-670", "descricao": "V10 F4 - 49MP00107136 / 06MP00108087", "preco": 92.41, "marca": "Unicoba"},
    {"id": 899231794, "codigo": "PH-640", "descricao": "V8 F2 - 49MP00107129 / 06MP00108082", "preco": 65.95, "marca": "Unicoba"},
    {"id": 892479348, "codigo": "PH-610", "descricao": "V9 F2 - 49MP00107152 / 06MP00108090", "preco": 69.86, "marca": "Unicoba"},
    {"id": 892481827, "codigo": "PH-620", "descricao": "V9 F3 - 49MP00107146 / 06MP00108091", "preco": 100.65, "marca": "Unicoba"},
    {"id": 892484645, "codigo": "PH-630", "descricao": "V9 F4 - 49MP00107156 / 06MP00108092", "preco": 113.16, "marca": "Unicoba"},
    {"id": 892469876, "codigo": "PH-501", "descricao": "Z31368604", "preco": 17.104, "marca": "Vibracoustic"},
    {"id": 892470129, "codigo": "PH-502", "descricao": "Z31368701", "preco": 30.872, "marca": "Vibracoustic"},
    {"id": 892471080, "codigo": "PH-503", "descricao": "Z31368802", "preco": 23.667, "marca": "Vibracoustic"},
    {"id": 892471503, "codigo": "PH-504", "descricao": "Z31368910", "preco": 33.941, "marca": "Vibracoustic"}
]


def get_product_by_code(codigo):
    """
    Search for a product by its code
    
    Args:
        codigo: Product code (e.g., "PH-504")
    
    Returns:
        Product dict or None if not found
    """
    for produto in PRODUTOS_DB:
        if str(produto.get('codigo')) == str(codigo):
            return produto
    return None


def get_product_by_id(product_id):
    """
    Search for a product by its ID
    
    Args:
        product_id: Product ID (e.g., 892471503)
    
    Returns:
        Product dict or None if not found
    """
    for produto in PRODUTOS_DB:
        if produto.get('id') == int(product_id):
            return produto
    return None


def get_all_products():
    """Return all products in the database"""
    return PRODUTOS_DB


def search_products(query):
    """
    Search products by code, description or brand
    
    Args:
        query: Search string
    
    Returns:
        List of matching products
    """
    query = str(query).lower()
    results = []
    
    for produto in PRODUTOS_DB:
        if (query in str(produto.get('codigo', '')).lower() or
            query in produto.get('descricao', '').lower() or
            query in produto.get('marca', '').lower()):
            results.append(produto)
    
    return results